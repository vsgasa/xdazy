#!/bin/bash
export UUID=${UUID:-'f6bf5ff2-023f-4c00-a572-22bbebae4fbc'}
export SERVER_PORT="${SERVER_PORT:-${PORT:-7860}}"
export NEZHA_SERVER=${NEZHA_SERVER:-'nz.abc.cn'} 
export NEZHA_PORT=${NEZHA_PORT:-'5555'}     
export NEZHA_KEY=${NEZHA_KEY:-''}  
export SNI=${SNI:-'www.yahoo.com'}
export FILE_PATH=${FILE_PATH:-'./.cache'}  # 节点路径

echo "QVJDSD0kKHVuYW1lIC1tKSAmJiBET1dOTE9BRF9ESVI9IiR7RklMRV9QQVRIfSIgJiYgbWtkaXIgLXAgIiRET1dOTE9BRF9ESVIiICYmIEZJTEVfSU5GTz0oKQppZiBbICIkQVJDSCIgPT0gImFybSIgXSB8fCBbICIkQVJDSCIgPT0gImFybTY0IiBdIHx8IFsgIiRBUkNIIiA9PSAiYWFyY2g2NCIgXTsgdGhlbgogICAgRklMRV9JTkZPPSgiaHR0cHM6Ly9naXRodWIuY29tL2Vvb2NlL3Rlc3QvcmVsZWFzZXMvZG93bmxvYWQvYXJtNjQveHJheSB3ZWIiICJodHRwczovL2dpdGh1Yi5jb20vZW9vY2UvdGVzdC9yZWxlYXNlcy9kb3dubG9hZC9BUk0vc3dpdGggbnBtIikKZWxpZiBbICIkQVJDSCIgPT0gImFtZDY0IiBdIHx8IFsgIiRBUkNIIiA9PSAieDg2XzY0IiBdIHx8IFsgIiRBUkNIIiA9PSAieDg2IiBdOyB0aGVuCiAgICBGSUxFX0lORk89KCJodHRwczovL2dpdGh1Yi5jb20vZW9vY2UvdGVzdC9yZWxlYXNlcy9kb3dubG9hZC9hbWQ2NC94cmF5IHdlYiIgImh0dHBzOi8vZ2l0aHViLmNvbS9lb29jZS90ZXN0L3JlbGVhc2VzL2Rvd25sb2FkL2J1bGlkL3N3aXRoIG5wbSIpCmVsc2UKICAgIGVjaG8gIlVuc3VwcG9ydGVkIGFyY2hpdGVjdHVyZTogJEFSQ0giCiAgICBleGl0IDEKZmkKZm9yIGVudHJ5IGluICIke0ZJTEVfSU5GT1tAXX0iOyBkbwogICAgVVJMPSQoZWNobyAiJGVudHJ5IiB8IGN1dCAtZCAnICcgLWYgMSkKICAgIE5FV19GSUxFTkFNRT0kKGVjaG8gIiRlbnRyeSIgfCBjdXQgLWQgJyAnIC1mIDIpCiAgICBGSUxFTkFNRT0iJERPV05MT0FEX0RJUi8kTkVXX0ZJTEVOQU1FIgogICAgaWYgWyAtZSAiJEZJTEVOQU1FIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiXGVbMTszMm0kRklMRU5BTUUgYWxyZWFkeSBleGlzdHMsU2tpcHBpbmcgZG93bmxvYWRcZVswbSIKICAgIGVsc2UKICAgICAgICBjdXJsIC1MIC1zUyAtbyAiJEZJTEVOQU1FIiAiJFVSTCIKICAgICAgICBlY2hvIC1lICJcZVsxOzMybURvd25sb2FkaW5nICRGSUxFTkFNRVxlWzBtIgogICAgZmkKICAgIGNobW9kICt4ICRGSUxFTkFNRQpkb25lCndhaXQKCiMgR2VuZXJhdGluZyBDb25maWd1cmF0aW9uIEZpbGVzCmdlbmVyYXRlX2NvbmZpZygpIHsKCiAgICBYMjU1MTlLZXk9JCguLyIke0ZJTEVfUEFUSH0vd2ViIiB4MjU1MTkpCiAgICBQcml2YXRlS2V5PSQoZWNobyAiJHtYMjU1MTlLZXl9IiB8IGhlYWQgLTEgfCBhd2sgJ3twcmludCAkM30nKQogICAgUHVibGljS2V5PSQoZWNobyAiJHtYMjU1MTlLZXl9IiB8IHRhaWwgLW4gMSB8IGF3ayAne3ByaW50ICQzfScpCiAgICBzaG9ydGlkPSQob3BlbnNzbCByYW5kIC1oZXggOCkKCiAgY2F0ID4gJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uIDw8IEVPRgp7CiAgICAiaW5ib3VuZHMiOiBbCiAgICAgICAgewogICAgICAgICAgICAicG9ydCI6ICRTRVJWRVJfUE9SVCwKICAgICAgICAgICAgInByb3RvY29sIjogInZsZXNzIiwKICAgICAgICAgICAgInNldHRpbmdzIjogewogICAgICAgICAgICAgICAgImNsaWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAiaWQiOiAiJFVVSUQiLAogICAgICAgICAgICAgICAgICAgICAgICAiZmxvdyI6ICJ4dGxzLXJwcngtdmlzaW9uIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAiZGVjcnlwdGlvbiI6ICJub25lIgogICAgICAgICAgICB9LAogICAgICAgICAgICAic3RyZWFtU2V0dGluZ3MiOiB7CiAgICAgICAgICAgICAgICAibmV0d29yayI6ICJ0Y3AiLAogICAgICAgICAgICAgICAgInNlY3VyaXR5IjogInJlYWxpdHkiLAogICAgICAgICAgICAgICAgInJlYWxpdHlTZXR0aW5ncyI6IHsKICAgICAgICAgICAgICAgICAgICAic2hvdyI6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICJkZXN0IjogIjEuMS4xLjE6NDQzIiwKICAgICAgICAgICAgICAgICAgICAieHZlciI6IDAsCiAgICAgICAgICAgICAgICAgICAgInNlcnZlck5hbWVzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAiJFNOSSIKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICJwcml2YXRlS2V5IjogIiRQcml2YXRlS2V5IiwKICAgICAgICAgICAgICAgICAgICAibWluQ2xpZW50VmVyIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIm1heENsaWVudFZlciI6ICIiLAogICAgICAgICAgICAgICAgICAgICJtYXhUaW1lRGlmZiI6IDAsCiAgICAgICAgICAgICAgICAgICAgInNob3J0SWRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAiJHNob3J0aWQiCiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgXSwKICAgICJvdXRib3VuZHMiOiBbCiAgICAgICAgewogICAgICAgICAgICAicHJvdG9jb2wiOiAiZnJlZWRvbSIsCiAgICAgICAgICAgICJ0YWciOiAiZGlyZWN0IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAicHJvdG9jb2wiOiAiYmxhY2tob2xlIiwKICAgICAgICAgICAgInRhZyI6ICJibG9ja2VkIgogICAgICAgIH0KICAgIF0gICAgCn0KRU9GCn0KZ2VuZXJhdGVfY29uZmlnCgojIHJ1bm5pbmcgZmlsZXMKcnVuKCkgewogIGlmIFsgLWUgIiR7RklMRV9QQVRIfS9ucG0iIF07IHRoZW4KICAgIGNobW9kIDc3NyAiJHtGSUxFX1BBVEh9L25wbSIKICAgIHRsc1BvcnRzPSgiNDQzIiAiODQ0MyIgIjIwOTYiICIyMDg3IiAiMjA4MyIgIjIwNTMiKQogICAgaWYgW1sgIiR7dGxzUG9ydHNbKl19IiA9fiAiJHtORVpIQV9QT1JUfSIgXV07IHRoZW4KICAgICAgTkVaSEFfVExTPSItLXRscyIKICAgIGVsc2UKICAgICAgTkVaSEFfVExTPSIiCiAgICBmaQogICAgaWYgWyAtbiAiJE5FWkhBX1NFUlZFUiIgXSAmJiBbIC1uICIkTkVaSEFfUE9SVCIgXSAmJiBbIC1uICIkTkVaSEFfS0VZIiBdOyB0aGVuCiAgICAgICAgbm9odXAgJHtGSUxFX1BBVEh9L25wbSAtcyAke05FWkhBX1NFUlZFUn06JHtORVpIQV9QT1JUfSAtcCAke05FWkhBX0tFWX0gJHtORVpIQV9UTFN9ID4vZGV2L251bGwgMj4mMSAmCgkgICAgIHNsZWVwIDEKICAgICAgIGVjaG8gLWUgIlxlWzE7MzJtbnBtIGlzIHJ1bm5pbmdcZVswbSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICJcZVsxOzM1bU5FWkhBIHZhcmlhYmxlIGlzIGVtcHR5LHNraXBpbmcgcnVuaW5nXGVbMG0iCiAgICBmaQogIGZpCgogIGlmIFsgLWUgIiR7RklMRV9QQVRIfS93ZWIiIF07IHRoZW4KICAgIGNobW9kIDc3NyAiJHtGSUxFX1BBVEh9L3dlYiIKICAgIG5vaHVwICR7RklMRV9QQVRIfS93ZWIgLWMgJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uID4vZGV2L251bGwgMj4mMSAmCiAgICBzbGVlcCAxCiAgICBlY2hvIC1lICJcZVsxOzMybXdlYiBpcyBydW5uaW5nXGVbMG0iCiAgZmkKCn0KcnVuCgojIGdldCBpcApJUD0kKGN1cmwgLXMgaHR0cHM6Ly9pcHY0LmljYW5oYXppcC5jb20pCgojIGdldCBpcGluZm8KSVNQPSQoY3VybCAtcyBodHRwczovL3NwZWVkLmNsb3VkZmxhcmUuY29tL21ldGEgfCBhd2sgLUZcIiAne3ByaW50ICQyNiItIiQxOH0nIHwgc2VkIC1lICdzLyAvXy9nJykKCmNhdCA+ICR7RklMRV9QQVRIfS9saXN0LnR4dCA8PEVPRgoKdmxlc3M6Ly8ke1VVSUR9QCR7SVB9OiR7U0VSVkVSX1BPUlR9P2VuY3J5cHRpb249bm9uZSZmbG93PXh0bHMtcnByeC12aXNpb24mc2VjdXJpdHk9cmVhbGl0eSZzbmk9JHtTTkl9JmZwPWNocm9tZSZwYms9JHtQdWJsaWNLZXl9JnNpZD0ke3Nob3J0aWR9JnR5cGU9dGNwJmhlYWRlclR5cGU9bm9uZSMkSVNQCgpFT0YKYmFzZTY0IC13MCAke0ZJTEVfUEFUSH0vbGlzdC50eHQgPiAke0ZJTEVfUEFUSH0vdXJsLnR4dApjYXQgJHtGSUxFX1BBVEh9L3VybC50eHQKZWNobyAtZSAiXG5cZVsxOzMybSR7RklMRV9QQVRIfS91cmwudHh0IHNhdmVkIHN1Y2Nlc3NmdWxseVxlWzBtIgpybSAtcmYgJHtGSUxFX1BBVEh9L2xpc3QudHh0ICR7RklMRV9QQVRIfS9ucG0gJHtGSUxFX1BBVEh9L3dlYgplY2hvICIiCnNsZWVwIDgKY2xlYXIKZWNobyAtZSAiXG5cZVsxOzMybUluc3RhbGwgc3VjY2VzcyFcZVswbSIKCmV4aXQgMA==" | base64 -d | bash
